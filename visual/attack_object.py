import numpy as np
import matplotlib.pyplot as plt
import os

nan = np.infty

results = [
{'patch_size': 15, 'step_size': 5, 'max_steps': 50, 'pts_bbox_NuScenes/car_AP_dist_0.5': 0.1527, 'pts_bbox_NuScenes/car_AP_dist_1.0': 0.4052, 'pts_bbox_NuScenes/car_AP_dist_2.0': 0.6308, 'pts_bbox_NuScenes/car_AP_dist_4.0': 0.736, 'pts_bbox_NuScenes/car_trans_err': 0.5529, 'pts_bbox_NuScenes/car_scale_err': 0.1635, 'pts_bbox_NuScenes/car_orient_err': 0.202, 'pts_bbox_NuScenes/car_vel_err': 0.2125, 'pts_bbox_NuScenes/car_attr_err': 0.0783, 'pts_bbox_NuScenes/mATE': 0.7736, 'pts_bbox_NuScenes/mASE': 0.4642, 'pts_bbox_NuScenes/mAOE': 0.6622, 'pts_bbox_NuScenes/mAVE': 0.7642, 'pts_bbox_NuScenes/mAAE': 0.3103, 'pts_bbox_NuScenes/truck_AP_dist_0.5': 0.0576, 'pts_bbox_NuScenes/truck_AP_dist_1.0': 0.1629, 'pts_bbox_NuScenes/truck_AP_dist_2.0': 0.3718, 'pts_bbox_NuScenes/truck_AP_dist_4.0': 0.4387, 'pts_bbox_NuScenes/truck_trans_err': 0.6713, 'pts_bbox_NuScenes/truck_scale_err': 0.1852, 'pts_bbox_NuScenes/truck_orient_err': 0.0971, 'pts_bbox_NuScenes/truck_vel_err': 0.0928, 'pts_bbox_NuScenes/truck_attr_err': 0.0053, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_trans_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_scale_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_orient_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_vel_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_attr_err': 1.0, 'pts_bbox_NuScenes/bus_AP_dist_0.5': 0.0039, 'pts_bbox_NuScenes/bus_AP_dist_1.0': 0.157, 'pts_bbox_NuScenes/bus_AP_dist_2.0': 0.6705, 'pts_bbox_NuScenes/bus_AP_dist_4.0': 0.7561, 'pts_bbox_NuScenes/bus_trans_err': 0.9653, 'pts_bbox_NuScenes/bus_scale_err': 0.1222, 'pts_bbox_NuScenes/bus_orient_err': 0.2624, 'pts_bbox_NuScenes/bus_vel_err': 1.9992, 'pts_bbox_NuScenes/bus_attr_err': 0.0605, 'pts_bbox_NuScenes/trailer_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/trailer_trans_err': 1.0, 'pts_bbox_NuScenes/trailer_scale_err': 1.0, 'pts_bbox_NuScenes/trailer_orient_err': 1.0, 'pts_bbox_NuScenes/trailer_vel_err': 1.0, 'pts_bbox_NuScenes/trailer_attr_err': 1.0, 'pts_bbox_NuScenes/barrier_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/barrier_trans_err': 1.0, 'pts_bbox_NuScenes/barrier_scale_err': 1.0, 'pts_bbox_NuScenes/barrier_orient_err': 1.0, 'pts_bbox_NuScenes/barrier_vel_err': nan, 'pts_bbox_NuScenes/barrier_attr_err': nan, 'pts_bbox_NuScenes/motorcycle_AP_dist_0.5': 0.0053, 'pts_bbox_NuScenes/motorcycle_AP_dist_1.0': 0.0539, 'pts_bbox_NuScenes/motorcycle_AP_dist_2.0': 0.1109, 'pts_bbox_NuScenes/motorcycle_AP_dist_4.0': 0.141, 'pts_bbox_NuScenes/motorcycle_trans_err': 0.6985, 'pts_bbox_NuScenes/motorcycle_scale_err': 0.2992, 'pts_bbox_NuScenes/motorcycle_orient_err': 0.9375, 'pts_bbox_NuScenes/motorcycle_vel_err': 0.092, 'pts_bbox_NuScenes/motorcycle_attr_err': 0.0441, 'pts_bbox_NuScenes/bicycle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/bicycle_AP_dist_1.0': 0.0113, 'pts_bbox_NuScenes/bicycle_AP_dist_2.0': 0.0374, 'pts_bbox_NuScenes/bicycle_AP_dist_4.0': 0.0374, 'pts_bbox_NuScenes/bicycle_trans_err': 0.771, 'pts_bbox_NuScenes/bicycle_scale_err': 0.2586, 'pts_bbox_NuScenes/bicycle_orient_err': 0.9353, 'pts_bbox_NuScenes/bicycle_vel_err': 1.2877, 'pts_bbox_NuScenes/bicycle_attr_err': 0.0589, 'pts_bbox_NuScenes/pedestrian_AP_dist_0.5': 0.0551, 'pts_bbox_NuScenes/pedestrian_AP_dist_1.0': 0.2255, 'pts_bbox_NuScenes/pedestrian_AP_dist_2.0': 0.3909, 'pts_bbox_NuScenes/pedestrian_AP_dist_4.0': 0.4631, 'pts_bbox_NuScenes/pedestrian_trans_err': 0.6781, 'pts_bbox_NuScenes/pedestrian_scale_err': 0.2573, 'pts_bbox_NuScenes/pedestrian_orient_err': 0.5255, 'pts_bbox_NuScenes/pedestrian_vel_err': 0.4297, 'pts_bbox_NuScenes/pedestrian_attr_err': 0.2353, 'pts_bbox_NuScenes/traffic_cone_AP_dist_0.5': 0.2738, 'pts_bbox_NuScenes/traffic_cone_AP_dist_1.0': 0.407, 'pts_bbox_NuScenes/traffic_cone_AP_dist_2.0': 0.4844, 'pts_bbox_NuScenes/traffic_cone_AP_dist_4.0': 0.51, 'pts_bbox_NuScenes/traffic_cone_trans_err': 0.3986, 'pts_bbox_NuScenes/traffic_cone_scale_err': 0.3559, 'pts_bbox_NuScenes/traffic_cone_orient_err': nan, 'pts_bbox_NuScenes/traffic_cone_vel_err': nan, 'pts_bbox_NuScenes/traffic_cone_attr_err': nan, 'pts_bbox_NuScenes/NDS': 0.29942647233772923, 'pts_bbox_NuScenes/mAP': 0.1937512399635759},
{'patch_size': 25, 'step_size': 5, 'max_steps': 50, 'pts_bbox_NuScenes/car_AP_dist_0.5': 0.1277, 'pts_bbox_NuScenes/car_AP_dist_1.0': 0.3181, 'pts_bbox_NuScenes/car_AP_dist_2.0': 0.4925, 'pts_bbox_NuScenes/car_AP_dist_4.0': 0.5904, 'pts_bbox_NuScenes/car_trans_err': 0.5439, 'pts_bbox_NuScenes/car_scale_err': 0.1665, 'pts_bbox_NuScenes/car_orient_err': 0.2338, 'pts_bbox_NuScenes/car_vel_err': 0.1976, 'pts_bbox_NuScenes/car_attr_err': 0.0838, 'pts_bbox_NuScenes/mATE': 0.7717, 'pts_bbox_NuScenes/mASE': 0.465, 'pts_bbox_NuScenes/mAOE': 0.678, 'pts_bbox_NuScenes/mAVE': 0.7995, 'pts_bbox_NuScenes/mAAE': 0.3288, 'pts_bbox_NuScenes/truck_AP_dist_0.5': 0.0246, 'pts_bbox_NuScenes/truck_AP_dist_1.0': 0.0629, 'pts_bbox_NuScenes/truck_AP_dist_2.0': 0.1913, 'pts_bbox_NuScenes/truck_AP_dist_4.0': 0.2296, 'pts_bbox_NuScenes/truck_trans_err': 0.6462, 'pts_bbox_NuScenes/truck_scale_err': 0.1906, 'pts_bbox_NuScenes/truck_orient_err': 0.1426, 'pts_bbox_NuScenes/truck_vel_err': 0.0863, 'pts_bbox_NuScenes/truck_attr_err': 0.0042, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_trans_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_scale_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_orient_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_vel_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_attr_err': 1.0, 'pts_bbox_NuScenes/bus_AP_dist_0.5': 0.0309, 'pts_bbox_NuScenes/bus_AP_dist_1.0': 0.1996, 'pts_bbox_NuScenes/bus_AP_dist_2.0': 0.6928, 'pts_bbox_NuScenes/bus_AP_dist_4.0': 0.7527, 'pts_bbox_NuScenes/bus_trans_err': 0.9348, 'pts_bbox_NuScenes/bus_scale_err': 0.1231, 'pts_bbox_NuScenes/bus_orient_err': 0.3087, 'pts_bbox_NuScenes/bus_vel_err': 2.2435, 'pts_bbox_NuScenes/bus_attr_err': 0.1627, 'pts_bbox_NuScenes/trailer_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/trailer_trans_err': 1.0, 'pts_bbox_NuScenes/trailer_scale_err': 1.0, 'pts_bbox_NuScenes/trailer_orient_err': 1.0, 'pts_bbox_NuScenes/trailer_vel_err': 1.0, 'pts_bbox_NuScenes/trailer_attr_err': 1.0, 'pts_bbox_NuScenes/barrier_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/barrier_trans_err': 1.0, 'pts_bbox_NuScenes/barrier_scale_err': 1.0, 'pts_bbox_NuScenes/barrier_orient_err': 1.0, 'pts_bbox_NuScenes/barrier_vel_err': nan, 'pts_bbox_NuScenes/barrier_attr_err': nan, 'pts_bbox_NuScenes/motorcycle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/motorcycle_AP_dist_1.0': 0.0026, 'pts_bbox_NuScenes/motorcycle_AP_dist_2.0': 0.0252, 'pts_bbox_NuScenes/motorcycle_AP_dist_4.0': 0.0303, 'pts_bbox_NuScenes/motorcycle_trans_err': 0.8089, 'pts_bbox_NuScenes/motorcycle_scale_err': 0.316, 'pts_bbox_NuScenes/motorcycle_orient_err': 1.1098, 'pts_bbox_NuScenes/motorcycle_vel_err': 0.1287, 'pts_bbox_NuScenes/motorcycle_attr_err': 0.0385, 'pts_bbox_NuScenes/bicycle_AP_dist_0.5': 0.0021, 'pts_bbox_NuScenes/bicycle_AP_dist_1.0': 0.0022, 'pts_bbox_NuScenes/bicycle_AP_dist_2.0': 0.0169, 'pts_bbox_NuScenes/bicycle_AP_dist_4.0': 0.0169, 'pts_bbox_NuScenes/bicycle_trans_err': 0.6757, 'pts_bbox_NuScenes/bicycle_scale_err': 0.2503, 'pts_bbox_NuScenes/bicycle_orient_err': 0.8094, 'pts_bbox_NuScenes/bicycle_vel_err': 1.2457, 'pts_bbox_NuScenes/bicycle_attr_err': 0.058, 'pts_bbox_NuScenes/pedestrian_AP_dist_0.5': 0.0233, 'pts_bbox_NuScenes/pedestrian_AP_dist_1.0': 0.1336, 'pts_bbox_NuScenes/pedestrian_AP_dist_2.0': 0.2496, 'pts_bbox_NuScenes/pedestrian_AP_dist_4.0': 0.3049, 'pts_bbox_NuScenes/pedestrian_trans_err': 0.6945, 'pts_bbox_NuScenes/pedestrian_scale_err': 0.2653, 'pts_bbox_NuScenes/pedestrian_orient_err': 0.4974, 'pts_bbox_NuScenes/pedestrian_vel_err': 0.4939, 'pts_bbox_NuScenes/pedestrian_attr_err': 0.2833, 'pts_bbox_NuScenes/traffic_cone_AP_dist_0.5': 0.145, 'pts_bbox_NuScenes/traffic_cone_AP_dist_1.0': 0.1992, 'pts_bbox_NuScenes/traffic_cone_AP_dist_2.0': 0.2731, 'pts_bbox_NuScenes/traffic_cone_AP_dist_4.0': 0.2845, 'pts_bbox_NuScenes/traffic_cone_trans_err': 0.4132, 'pts_bbox_NuScenes/traffic_cone_scale_err': 0.338, 'pts_bbox_NuScenes/traffic_cone_orient_err': nan, 'pts_bbox_NuScenes/traffic_cone_vel_err': nan, 'pts_bbox_NuScenes/traffic_cone_attr_err': nan, 'pts_bbox_NuScenes/NDS': 0.2634933997763062, 'pts_bbox_NuScenes/mAP': 0.13556957062335306},
{'patch_size': 5, 'step_size': 5, 'max_steps': 50, 'pts_bbox_NuScenes/car_AP_dist_0.5': 0.1978, 'pts_bbox_NuScenes/car_AP_dist_1.0': 0.4971, 'pts_bbox_NuScenes/car_AP_dist_2.0': 0.7613, 'pts_bbox_NuScenes/car_AP_dist_4.0': 0.8571, 'pts_bbox_NuScenes/car_trans_err': 0.532, 'pts_bbox_NuScenes/car_scale_err': 0.162, 'pts_bbox_NuScenes/car_orient_err': 0.1451, 'pts_bbox_NuScenes/car_vel_err': 0.238, 'pts_bbox_NuScenes/car_attr_err': 0.0773, 'pts_bbox_NuScenes/mATE': 0.7935, 'pts_bbox_NuScenes/mASE': 0.4607, 'pts_bbox_NuScenes/mAOE': 0.6712, 'pts_bbox_NuScenes/mAVE': 0.8043, 'pts_bbox_NuScenes/mAAE': 0.3114, 'pts_bbox_NuScenes/truck_AP_dist_0.5': 0.143, 'pts_bbox_NuScenes/truck_AP_dist_1.0': 0.2383, 'pts_bbox_NuScenes/truck_AP_dist_2.0': 0.5999, 'pts_bbox_NuScenes/truck_AP_dist_4.0': 0.6774, 'pts_bbox_NuScenes/truck_trans_err': 0.7026, 'pts_bbox_NuScenes/truck_scale_err': 0.1931, 'pts_bbox_NuScenes/truck_orient_err': 0.095, 'pts_bbox_NuScenes/truck_vel_err': 0.1148, 'pts_bbox_NuScenes/truck_attr_err': 0.0086, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_trans_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_scale_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_orient_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_vel_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_attr_err': 1.0, 'pts_bbox_NuScenes/bus_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/bus_AP_dist_1.0': 0.1392, 'pts_bbox_NuScenes/bus_AP_dist_2.0': 0.7266, 'pts_bbox_NuScenes/bus_AP_dist_4.0': 0.8233, 'pts_bbox_NuScenes/bus_trans_err': 0.9727, 'pts_bbox_NuScenes/bus_scale_err': 0.1222, 'pts_bbox_NuScenes/bus_orient_err': 0.3119, 'pts_bbox_NuScenes/bus_vel_err': 2.0169, 'pts_bbox_NuScenes/bus_attr_err': 0.124, 'pts_bbox_NuScenes/trailer_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/trailer_trans_err': 1.0, 'pts_bbox_NuScenes/trailer_scale_err': 1.0, 'pts_bbox_NuScenes/trailer_orient_err': 1.0, 'pts_bbox_NuScenes/trailer_vel_err': 1.0, 'pts_bbox_NuScenes/trailer_attr_err': 1.0, 'pts_bbox_NuScenes/barrier_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/barrier_trans_err': 1.0, 'pts_bbox_NuScenes/barrier_scale_err': 1.0, 'pts_bbox_NuScenes/barrier_orient_err': 1.0, 'pts_bbox_NuScenes/barrier_vel_err': nan, 'pts_bbox_NuScenes/barrier_attr_err': nan, 'pts_bbox_NuScenes/motorcycle_AP_dist_0.5': 0.0307, 'pts_bbox_NuScenes/motorcycle_AP_dist_1.0': 0.1626, 'pts_bbox_NuScenes/motorcycle_AP_dist_2.0': 0.3664, 'pts_bbox_NuScenes/motorcycle_AP_dist_4.0': 0.4583, 'pts_bbox_NuScenes/motorcycle_trans_err': 0.7371, 'pts_bbox_NuScenes/motorcycle_scale_err': 0.2842, 'pts_bbox_NuScenes/motorcycle_orient_err': 0.9727, 'pts_bbox_NuScenes/motorcycle_vel_err': 0.0838, 'pts_bbox_NuScenes/motorcycle_attr_err': 0.0122, 'pts_bbox_NuScenes/bicycle_AP_dist_0.5': 0.005, 'pts_bbox_NuScenes/bicycle_AP_dist_1.0': 0.0285, 'pts_bbox_NuScenes/bicycle_AP_dist_2.0': 0.1028, 'pts_bbox_NuScenes/bicycle_AP_dist_4.0': 0.1048, 'pts_bbox_NuScenes/bicycle_trans_err': 0.7907, 'pts_bbox_NuScenes/bicycle_scale_err': 0.2436, 'pts_bbox_NuScenes/bicycle_orient_err': 1.0252, 'pts_bbox_NuScenes/bicycle_vel_err': 1.5864, 'pts_bbox_NuScenes/bicycle_attr_err': 0.0691, 'pts_bbox_NuScenes/pedestrian_AP_dist_0.5': 0.0594, 'pts_bbox_NuScenes/pedestrian_AP_dist_1.0': 0.2898, 'pts_bbox_NuScenes/pedestrian_AP_dist_2.0': 0.551, 'pts_bbox_NuScenes/pedestrian_AP_dist_4.0': 0.6723, 'pts_bbox_NuScenes/pedestrian_trans_err': 0.7315, 'pts_bbox_NuScenes/pedestrian_scale_err': 0.2493, 'pts_bbox_NuScenes/pedestrian_orient_err': 0.4909, 'pts_bbox_NuScenes/pedestrian_vel_err': 0.3942, 'pts_bbox_NuScenes/pedestrian_attr_err': 0.1997, 'pts_bbox_NuScenes/traffic_cone_AP_dist_0.5': 0.2762, 'pts_bbox_NuScenes/traffic_cone_AP_dist_1.0': 0.4587, 'pts_bbox_NuScenes/traffic_cone_AP_dist_2.0': 0.5985, 'pts_bbox_NuScenes/traffic_cone_AP_dist_4.0': 0.6582, 'pts_bbox_NuScenes/traffic_cone_trans_err': 0.4688, 'pts_bbox_NuScenes/traffic_cone_scale_err': 0.353, 'pts_bbox_NuScenes/traffic_cone_orient_err': nan, 'pts_bbox_NuScenes/traffic_cone_vel_err': nan, 'pts_bbox_NuScenes/traffic_cone_attr_err': nan, 'pts_bbox_NuScenes/NDS': 0.3269416677328915, 'pts_bbox_NuScenes/mAP': 0.26209579358518054},
{'patch_size': 35, 'step_size': 5, 'max_steps': 50, 'pts_bbox_NuScenes/car_AP_dist_0.5': 0.0996, 'pts_bbox_NuScenes/car_AP_dist_1.0': 0.2299, 'pts_bbox_NuScenes/car_AP_dist_2.0': 0.3806, 'pts_bbox_NuScenes/car_AP_dist_4.0': 0.4598, 'pts_bbox_NuScenes/car_trans_err': 0.5365, 'pts_bbox_NuScenes/car_scale_err': 0.1651, 'pts_bbox_NuScenes/car_orient_err': 0.2566, 'pts_bbox_NuScenes/car_vel_err': 0.2085, 'pts_bbox_NuScenes/car_attr_err': 0.0901, 'pts_bbox_NuScenes/mATE': 0.752, 'pts_bbox_NuScenes/mASE': 0.4736, 'pts_bbox_NuScenes/mAOE': 0.6877, 'pts_bbox_NuScenes/mAVE': 0.7976, 'pts_bbox_NuScenes/mAAE': 0.3405, 'pts_bbox_NuScenes/truck_AP_dist_0.5': 0.0123, 'pts_bbox_NuScenes/truck_AP_dist_1.0': 0.0443, 'pts_bbox_NuScenes/truck_AP_dist_2.0': 0.1016, 'pts_bbox_NuScenes/truck_AP_dist_4.0': 0.128, 'pts_bbox_NuScenes/truck_trans_err': 0.536, 'pts_bbox_NuScenes/truck_scale_err': 0.1956, 'pts_bbox_NuScenes/truck_orient_err': 0.1837, 'pts_bbox_NuScenes/truck_vel_err': 0.0901, 'pts_bbox_NuScenes/truck_attr_err': 0.0411, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_trans_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_scale_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_orient_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_vel_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_attr_err': 1.0, 'pts_bbox_NuScenes/bus_AP_dist_0.5': 0.0587, 'pts_bbox_NuScenes/bus_AP_dist_1.0': 0.2671, 'pts_bbox_NuScenes/bus_AP_dist_2.0': 0.6477, 'pts_bbox_NuScenes/bus_AP_dist_4.0': 0.7394, 'pts_bbox_NuScenes/bus_trans_err': 0.7875, 'pts_bbox_NuScenes/bus_scale_err': 0.1314, 'pts_bbox_NuScenes/bus_orient_err': 0.2654, 'pts_bbox_NuScenes/bus_vel_err': 2.3426, 'pts_bbox_NuScenes/bus_attr_err': 0.183, 'pts_bbox_NuScenes/trailer_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/trailer_trans_err': 1.0, 'pts_bbox_NuScenes/trailer_scale_err': 1.0, 'pts_bbox_NuScenes/trailer_orient_err': 1.0, 'pts_bbox_NuScenes/trailer_vel_err': 1.0, 'pts_bbox_NuScenes/trailer_attr_err': 1.0, 'pts_bbox_NuScenes/barrier_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/barrier_trans_err': 1.0, 'pts_bbox_NuScenes/barrier_scale_err': 1.0, 'pts_bbox_NuScenes/barrier_orient_err': 1.0, 'pts_bbox_NuScenes/barrier_vel_err': nan, 'pts_bbox_NuScenes/barrier_attr_err': nan, 'pts_bbox_NuScenes/motorcycle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/motorcycle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/motorcycle_AP_dist_2.0': 0.001, 'pts_bbox_NuScenes/motorcycle_AP_dist_4.0': 0.0041, 'pts_bbox_NuScenes/motorcycle_trans_err': 0.8414, 'pts_bbox_NuScenes/motorcycle_scale_err': 0.3251, 'pts_bbox_NuScenes/motorcycle_orient_err': 1.12, 'pts_bbox_NuScenes/motorcycle_vel_err': 0.0781, 'pts_bbox_NuScenes/motorcycle_attr_err': 0.0, 'pts_bbox_NuScenes/bicycle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/bicycle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/bicycle_AP_dist_2.0': 0.0009, 'pts_bbox_NuScenes/bicycle_AP_dist_4.0': 0.0009, 'pts_bbox_NuScenes/bicycle_trans_err': 0.7513, 'pts_bbox_NuScenes/bicycle_scale_err': 0.2855, 'pts_bbox_NuScenes/bicycle_orient_err': 0.8407, 'pts_bbox_NuScenes/bicycle_vel_err': 1.1224, 'pts_bbox_NuScenes/bicycle_attr_err': 0.0956, 'pts_bbox_NuScenes/pedestrian_AP_dist_0.5': 0.0182, 'pts_bbox_NuScenes/pedestrian_AP_dist_1.0': 0.091, 'pts_bbox_NuScenes/pedestrian_AP_dist_2.0': 0.175, 'pts_bbox_NuScenes/pedestrian_AP_dist_4.0': 0.2196, 'pts_bbox_NuScenes/pedestrian_trans_err': 0.6461, 'pts_bbox_NuScenes/pedestrian_scale_err': 0.2756, 'pts_bbox_NuScenes/pedestrian_orient_err': 0.5232, 'pts_bbox_NuScenes/pedestrian_vel_err': 0.5389, 'pts_bbox_NuScenes/pedestrian_attr_err': 0.3143, 'pts_bbox_NuScenes/traffic_cone_AP_dist_0.5': 0.1068, 'pts_bbox_NuScenes/traffic_cone_AP_dist_1.0': 0.1591, 'pts_bbox_NuScenes/traffic_cone_AP_dist_2.0': 0.2042, 'pts_bbox_NuScenes/traffic_cone_AP_dist_4.0': 0.2191, 'pts_bbox_NuScenes/traffic_cone_trans_err': 0.4209, 'pts_bbox_NuScenes/traffic_cone_scale_err': 0.3576, 'pts_bbox_NuScenes/traffic_cone_orient_err': nan, 'pts_bbox_NuScenes/traffic_cone_vel_err': nan, 'pts_bbox_NuScenes/traffic_cone_attr_err': nan, 'pts_bbox_NuScenes/NDS': 0.24947282053908873, 'pts_bbox_NuScenes/mAP': 0.1092243631971396},
{'patch_size': 0, 'step_size': 5, 'max_steps': 50, 'pts_bbox_NuScenes/car_AP_dist_0.5': 0.2024, 'pts_bbox_NuScenes/car_AP_dist_1.0': 0.5217, 'pts_bbox_NuScenes/car_AP_dist_2.0': 0.7948, 'pts_bbox_NuScenes/car_AP_dist_4.0': 0.8998, 'pts_bbox_NuScenes/car_trans_err': 0.519, 'pts_bbox_NuScenes/car_scale_err': 0.1614, 'pts_bbox_NuScenes/car_orient_err': 0.1439, 'pts_bbox_NuScenes/car_vel_err': 0.2223, 'pts_bbox_NuScenes/car_attr_err': 0.0758, 'pts_bbox_NuScenes/mATE': 0.7872, 'pts_bbox_NuScenes/mASE': 0.4553, 'pts_bbox_NuScenes/mAOE': 0.6688, 'pts_bbox_NuScenes/mAVE': 0.8114, 'pts_bbox_NuScenes/mAAE': 0.3072, 'pts_bbox_NuScenes/truck_AP_dist_0.5': 0.1397, 'pts_bbox_NuScenes/truck_AP_dist_1.0': 0.2995, 'pts_bbox_NuScenes/truck_AP_dist_2.0': 0.6035, 'pts_bbox_NuScenes/truck_AP_dist_4.0': 0.7796, 'pts_bbox_NuScenes/truck_trans_err': 0.6165, 'pts_bbox_NuScenes/truck_scale_err': 0.1814, 'pts_bbox_NuScenes/truck_orient_err': 0.0978, 'pts_bbox_NuScenes/truck_vel_err': 0.1441, 'pts_bbox_NuScenes/truck_attr_err': 0.0131, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/construction_vehicle_trans_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_scale_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_orient_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_vel_err': 1.0, 'pts_bbox_NuScenes/construction_vehicle_attr_err': 1.0, 'pts_bbox_NuScenes/bus_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/bus_AP_dist_1.0': 0.163, 'pts_bbox_NuScenes/bus_AP_dist_2.0': 0.6839, 'pts_bbox_NuScenes/bus_AP_dist_4.0': 0.8251, 'pts_bbox_NuScenes/bus_trans_err': 1.0305, 'pts_bbox_NuScenes/bus_scale_err': 0.1233, 'pts_bbox_NuScenes/bus_orient_err': 0.2902, 'pts_bbox_NuScenes/bus_vel_err': 2.063, 'pts_bbox_NuScenes/bus_attr_err': 0.124, 'pts_bbox_NuScenes/trailer_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/trailer_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/trailer_trans_err': 1.0, 'pts_bbox_NuScenes/trailer_scale_err': 1.0, 'pts_bbox_NuScenes/trailer_orient_err': 1.0, 'pts_bbox_NuScenes/trailer_vel_err': 1.0, 'pts_bbox_NuScenes/trailer_attr_err': 1.0, 'pts_bbox_NuScenes/barrier_AP_dist_0.5': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_1.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_2.0': 0.0, 'pts_bbox_NuScenes/barrier_AP_dist_4.0': 0.0, 'pts_bbox_NuScenes/barrier_trans_err': 1.0, 'pts_bbox_NuScenes/barrier_scale_err': 1.0, 'pts_bbox_NuScenes/barrier_orient_err': 1.0, 'pts_bbox_NuScenes/barrier_vel_err': nan, 'pts_bbox_NuScenes/barrier_attr_err': nan, 'pts_bbox_NuScenes/motorcycle_AP_dist_0.5': 0.1136, 'pts_bbox_NuScenes/motorcycle_AP_dist_1.0': 0.3703, 'pts_bbox_NuScenes/motorcycle_AP_dist_2.0': 0.5684, 'pts_bbox_NuScenes/motorcycle_AP_dist_4.0': 0.7293, 'pts_bbox_NuScenes/motorcycle_trans_err': 0.6506, 'pts_bbox_NuScenes/motorcycle_scale_err': 0.2868, 'pts_bbox_NuScenes/motorcycle_orient_err': 0.9451, 'pts_bbox_NuScenes/motorcycle_vel_err': 0.0628, 'pts_bbox_NuScenes/motorcycle_attr_err': 0.0082, 'pts_bbox_NuScenes/bicycle_AP_dist_0.5': 0.0003, 'pts_bbox_NuScenes/bicycle_AP_dist_1.0': 0.0966, 'pts_bbox_NuScenes/bicycle_AP_dist_2.0': 0.3909, 'pts_bbox_NuScenes/bicycle_AP_dist_4.0': 0.4197, 'pts_bbox_NuScenes/bicycle_trans_err': 0.8548, 'pts_bbox_NuScenes/bicycle_scale_err': 0.2028, 'pts_bbox_NuScenes/bicycle_orient_err': 1.0056, 'pts_bbox_NuScenes/bicycle_vel_err': 1.592, 'pts_bbox_NuScenes/bicycle_attr_err': 0.0332, 'pts_bbox_NuScenes/pedestrian_AP_dist_0.5': 0.0827, 'pts_bbox_NuScenes/pedestrian_AP_dist_1.0': 0.3631, 'pts_bbox_NuScenes/pedestrian_AP_dist_2.0': 0.6654, 'pts_bbox_NuScenes/pedestrian_AP_dist_4.0': 0.8378, 'pts_bbox_NuScenes/pedestrian_trans_err': 0.717, 'pts_bbox_NuScenes/pedestrian_scale_err': 0.2494, 'pts_bbox_NuScenes/pedestrian_orient_err': 0.5368, 'pts_bbox_NuScenes/pedestrian_vel_err': 0.4072, 'pts_bbox_NuScenes/pedestrian_attr_err': 0.203, 'pts_bbox_NuScenes/traffic_cone_AP_dist_0.5': 0.2977, 'pts_bbox_NuScenes/traffic_cone_AP_dist_1.0': 0.5125, 'pts_bbox_NuScenes/traffic_cone_AP_dist_2.0': 0.6606, 'pts_bbox_NuScenes/traffic_cone_AP_dist_4.0': 0.7199, 'pts_bbox_NuScenes/traffic_cone_trans_err': 0.4834, 'pts_bbox_NuScenes/traffic_cone_scale_err': 0.3474, 'pts_bbox_NuScenes/traffic_cone_orient_err': nan, 'pts_bbox_NuScenes/traffic_cone_vel_err': nan, 'pts_bbox_NuScenes/traffic_cone_attr_err': nan, 'pts_bbox_NuScenes/NDS': 0.35628657214512105, 'pts_bbox_NuScenes/mAP': 0.31854038050372957}
]


CLASSES = ['car', 'bus', 'truck', 'trailer', 'construction_vehicle', 'pedestrian', 'motorcycle', 'bicycle', 'traffic_cone', 'barrier']
CLASSES_METRIC = ['AP', 'trans_err', 'scale_err', 'orient_err', 'vel_err', 'attr_err']
METRICS = ['mATE', 'mASE', 'mAOE', 'mAVE', 'mAAE']

def collect_data(data, metric, catagory):

    results = []

    for i in range(len(data)):
        data_ = data[i]
        result = dict()
        result['patch_size'] = data_['patch_size']
        result['step_size'] = data_['step_size']
        result['max_steps'] = data_['max_steps']
        result[f'{catagory}_{metric}'] = 0
        num = 0
        for key in data_.keys():
            if metric in key and catagory in key:
                result[f'{catagory}_{metric}'] += data_[key]
                num = num + 1
        # calculate average ap under different threshold
        result[f'{catagory}_{metric}'] /= num
        results.append(result)

    return results


def plot_api(x, y, xtitle, ytitle, out_path):
    
    plt.plot(x, y, 'o-', color='steelblue')
    plt.xlabel(xtitle)
    plt.ylabel(ytitle)
    plt.savefig(out_path)
    plt.cla()

def visualize_object(data):
    """Visualize metric of different object according to experiment settings (e.x. patch_size, step_size, etc.)
    Args:
        data (list): each element is a dict output by the model
    """
    for class_ in CLASSES:
        for metric_ in CLASSES_METRIC:
            if metric_ == 'AP':
                result = collect_data(data, metric_, class_)
                result.sort(key=lambda k: k['patch_size'])
                x = [exp['patch_size'] for exp in result]
                y = [exp[f'{class_}_{metric_}'] for exp in result]
                plot_api(x, y, 'patch_size', f'{class_}_{metric_}', out_path=os.path.join('visual', 'patch_size', f'ap_{class_}.pdf'))
            


if __name__ == '__main__':
    visualize_object(results)